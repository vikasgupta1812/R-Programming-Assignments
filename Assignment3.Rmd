Assignment # 3
========================================================

Download the file
```{r}
fileUrl <- "https://d396qusza40orc.cloudfront.net/rprog%2Fdata%2FProgAssignment3-data.zip"

if (!file.exists("Assignment3-data.zip")) {
    download.file(fileUrl, destfile = "Assignment3-data.zip", method = "wget")
}
```

Unzip the file

```{r}
if (!file.exists("Assignment3-data")) {
    unzip("Assignment3-data.zip", overwrite = TRUE)
}
```


```{r}
getwd()
```


1 Plot the 30-day mortality rates for heart attack
```{r}
outcome <- read.csv("outcome-of-care-measures.csv", colClasses = "character")
head(outcome)
```

Number of columns 
```{r}
ncol(outcome)
```


```{r}
names(outcome)
```

To make a simple histogram of the 30-day death rates from heart attack (column 11 in the outcome dataset), run
```{r}
names(outcome)[11]
outcome[, 11] <- as.numeric(outcome[, 11])
## You may get a warning about NAs being introduced; that is okay
```

```{r fig.width=7, fig.height=6}
hist(outcome[, 11])
```


##2 Finding the best hospital in a state

Write a function called best that take two arguments: the 2-character abbreviated name of a state and an outcome name. The function reads the outcome-of-care-measures.csv file and returns a character vector with the name of the hospital that has the best (i.e. lowest) 30-day mortality for the specified outcome in that state. The hospital name is the name provided in the Hospital.Name variable. The outcomes can be one of “heart attack”, “heart failure”, or “pneumonia”. Hospitals that do not have data on a particular outcome should be excluded from the set of hospitals when deciding the rankings.


```{r}
best  <- function(state, outcome) {
  ## Read outcome data 
  df  <- read.csv('./outcome-of-care-measures.csv')
  ## Check that state and outome are valid
  outcomes   <- c("heart attack","heart failure","pneumonia")
  if (!(state %in% df$State)) {
    stop("invalid state")
  }
  
  if (!(outcome %in% outcomes)) {
    stop("invalid outcome")
  }
  
  ## Return hospital name in that state with lowest 30-day death 
  ## rate
}


```

Unit tests

```{r}
best("TX", "heart attack")
best("TX", "heart failure")
best("MD", "heart attack")
best("MD", "pneumonia")
best("BB", "heart attack")
best("NY", "hert attack")
```

```{r}
?read.csv
```


```{r}
df  <- read.csv('./outcome-of-care-measures.csv',
                colClasses=c('character',NA))


df  <- read.csv('./outcome-of-care-measures.csv',quote = "\"",
                colClasses=c("Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack"="numeric"))
head(df$State)
```

```{r}
df2  <- df
df2$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack[1:10]
```

```{r}
df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack[1:10]
class(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack[1:10])
```


```{r}
class(df$State)
```


```{r}
"BB" %in% df$State ## To Check if State is valid.
"AL" %in% df$State
```


```{r}
head(df$Hospital.Name)
```


```{r}
outcomes   <- c("heart attack","heart failure","pneumonia")
"heart attack" %in% outcomes
"hert attack" %in% outcomes
```

```{r}
if (!("BB" %in% df$State)) {
  stop("invalid state")
}
```


```{r}
if (!("hert attack" %in% outcomes)) {
  stop("invalid outcome")
}
```

```{r}
Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack
str(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)
```


```{r}
df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == "Not Available"
```


```{r}
df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack[1:10]
#as.numeric(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)[1:10]
#as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)[1:10]
as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))[1:10]
```

Max and Min
[refer-1](http://stat.ethz.ch/R-manual/R-devel/library/base/html/Extremes.html)



```{r}
max(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)))
min(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)))
max(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T)
min(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T)

```


```{r}
max(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),na.rm = T)
min(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),na.rm = T)
```


```{r}
df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == max(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T)

any(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == max(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T))


sum(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == max(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T))


```



```{r}
as.character(df[df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == max(as.numeric(as.character(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T), 2])


```


```{r}
df1  <- df[df$State == "TX",]


as.character(df1[as.numeric(as.character(df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)) == min(as.numeric(as.character(df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T), 2])


min(as.numeric(as.character(df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),na.rm = T)

df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack
df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == 12
any(df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == 12)
any(df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack == 12.0)
any(as.numeric(as.character(df1$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)) == 12.0)
```

